<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLASSIFIED - Mission Briefing</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Courier+Prime:wght@400;700&family=Special+Elite&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier Prime', monospace;
            background: linear-gradient(45deg, #2c1810, #3d2817, #2c1810);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        
        .dossier-container {
            width: 90vw;
            max-width: 800px;
            height: 85vh;
            position: relative;
            background: linear-gradient(135deg, #f4f1e8, #ede8d3);
            border: 3px solid #8b4513;
            border-radius: 10px;
            box-shadow: 
                0 0 30px rgba(0,0,0,0.5),
                inset 0 0 100px rgba(139,69,19,0.1);
            overflow: hidden;
        }
        
        .dossier-cover {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            background: 
                radial-gradient(circle at 20% 20%, rgba(139,69,19,0.1) 1px, transparent 1px),
                radial-gradient(circle at 80% 80%, rgba(139,69,19,0.1) 1px, transparent 1px),
                linear-gradient(135deg, #f4f1e8, #ede8d3);
            background-size: 40px 40px, 40px 40px, 100% 100%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dossier-cover:hover {
            background: 
                radial-gradient(circle at 20% 20%, rgba(139,69,19,0.15) 1px, transparent 1px),
                radial-gradient(circle at 80% 80%, rgba(139,69,19,0.15) 1px, transparent 1px),
                linear-gradient(135deg, #f6f3ea, #f0ebe6);
            background-size: 40px 40px, 40px 40px, 100% 100%;
        }
        
        .classified-stamp {
            position: absolute;
            font-family: 'Special Elite', cursive;
            font-size: 48px;
            font-weight: bold;
            color: #dc143c;
            transform: rotate(-25deg);
            opacity: 0.8;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            border: 6px solid #dc143c;
            padding: 15px 25px;
            background: rgba(220,20,60,0.1);
        }
        
        .stamp-1 {
            top: 15%;
            right: 10%;
        }
        
        .stamp-2 {
            bottom: 20%;
            left: 15%;
            transform: rotate(15deg);
            font-size: 36px;
        }
        
        .cover-content {
            text-align: center;
            background: rgba(255,255,255,0.9);
            padding: 40px;
            border: 2px solid #8b4513;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
            max-width: 500px;
        }
        
        .cover-title {
            font-family: 'Special Elite', cursive;
            font-size: 24px;
            color: #2c1810;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .cover-details {
            font-size: 14px;
            line-height: 1.8;
            color: #444;
            text-align: left;
        }
        
        .cover-field {
            margin-bottom: 10px;
            display: flex;
            align-items: flex-start;
        }
        
        .field-label {
            font-weight: bold;
            min-width: 120px;
            color: #8b4513;
        }
        
        .field-value {
            flex: 1;
        }
        
        .dossier-content {
            width: 100%;
            height: 100%;
            display: none;
            position: relative;
            background: linear-gradient(135deg, #f4f1e8, #ede8d3);
        }
        
        .tab-container {
            position: absolute;
            right: -3px;
            top: 20px;
            height: calc(100% - 40px);
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        
        .tab {
            width: 80px;
            height: 60px;
            background: #8b4513;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 0 10px 10px 0;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .tab.active {
            background: #dc143c;
            width: 85px;
            box-shadow: 0 0 15px rgba(220,20,60,0.5);
        }
        
        .tab.locked {
            background: #666;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .page-content {
            width: calc(100% - 100px);
            height: 100%;
            padding: 40px;
            overflow-y: auto;
            font-size: 16px;
            line-height: 1.6;
            color: #2c1810;
        }
        
        .page-header {
            font-family: 'Special Elite', cursive;
            font-size: 20px;
            color: #8b4513;
            margin-bottom: 30px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 2px solid #8b4513;
            padding-bottom: 10px;
        }
        
        .paragraph {
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(255,255,255,0.7);
            border-left: 4px solid #dc143c;
            border-radius: 5px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .paragraph-header {
            font-weight: bold;
            color: #dc143c;
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .typed-content {
            min-height: 100px;
        }
        
        .question-container {
            margin-top: 20px;
            padding: 20px;
            background: rgba(220,20,60,0.1);
            border: 2px solid #dc143c;
            border-radius: 5px;
            display: none;
        }
        
        .question-text {
            font-weight: bold;
            color: #8b4513;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .answer-option {
            padding: 12px 20px;
            background: #f4f1e8;
            border: 2px solid #8b4513;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }
        
        .answer-option:hover {
            background: #e8e0d0;
            border-color: #dc143c;
        }
        
        .feedback-message {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
            display: none;
        }
        
        .feedback-correct {
            background: rgba(0,128,0,0.2);
            color: #006400;
            border: 2px solid #006400;
        }
        
        .feedback-incorrect {
            background: rgba(220,20,60,0.2);
            color: #dc143c;
            border: 2px solid #dc143c;
        }
        
        .transition-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 30px 50px;
            border-radius: 10px;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            display: none;
            z-index: 1000;
        }
        
        .video-container {
            margin: 20px 0;
            text-align: center;
        }
        
        .video-link {
            display: inline-block;
            padding: 15px 30px;
            background: #dc143c;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            font-size: 18px;
            transition: all 0.3s ease;
        }
        
        .video-link:hover {
            background: #b91c3c;
            box-shadow: 0 0 15px rgba(220,20,60,0.5);
        }
        
        .final-link {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,128,0,0.9);
            color: white;
            padding: 30px 50px;
            border-radius: 10px;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            display: none;
            z-index: 1000;
            cursor: pointer;
            border: 3px solid #00ff00;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0,255,0,0.5); }
            50% { box-shadow: 0 0 40px rgba(0,255,0,0.8); }
        }
        
        .typewriter-cursor {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
            .dossier-container {
                width: 95vw;
                height: 90vh;
            }
            
            .cover-content {
                padding: 20px;
                max-width: 90%;
            }
            
            .cover-title {
                font-size: 18px;
            }
            
            .cover-details {
                font-size: 12px;
            }
            
            .page-content {
                padding: 20px;
                font-size: 14px;
            }
            
            .tab {
                width: 60px;
                height: 50px;
                font-size: 10px;
            }
            
            .tab.active {
                width: 65px;
            }
            
            .page-content {
                width: calc(100% - 80px);
            }
        }
    </style>
</head>
<body>
    <div class="dossier-container">
        <!-- Cover Page -->
        <div class="dossier-cover" id="dossier-cover">
            <div class="classified-stamp stamp-1">CLASSIFIED</div>
            <div class="classified-stamp stamp-2">TOP SECRET</div>
            
            <div class="cover-content">
                <div class="cover-title">Agent 007 Field Report<br>For Zach's Eyes Only</div>
                
                <div class="cover-details">
                    <div class="cover-field">
                        <span class="field-label">MISSION FILE:</span>
                        <span class="field-value">CLASSIFIED</span>
                    </div>
                    <div class="cover-field">
                        <span class="field-label">Agent:</span>
                        <span class="field-value">Scott (Codename: Switch Hunter)</span>
                    </div>
                    <div class="cover-field">
                        <span class="field-label">Mission:</span>
                        <span class="field-value">Acquire Nintendo Switch 2 console via covert operation</span>
                    </div>
                    <div class="cover-field">
                        <span class="field-label">Classification:</span>
                        <span class="field-value">TOP SECRET - Eyes Only</span>
                    </div>
                    <div class="cover-field">
                        <span class="field-label">Target:</span>
                        <span class="field-value">Zach (Asset requiring protection and equipment)</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Dossier Content -->
        <div class="dossier-content" id="dossier-content">
            <div class="tab-container">
                <div class="tab active" data-page="0">PAGE 1</div>
                <div class="tab locked" data-page="1">PAGE 2</div>
                <div class="tab locked" data-page="2">PAGE 3</div>
                <div class="tab locked" data-page="3">PAGE 4</div>
            </div>
            
            <div class="page-content" id="page-content">
                <!-- Content will be dynamically loaded here -->
            </div>
            
            <div class="transition-message" id="transition-message"></div>
            <div class="final-link" id="final-link">
                <div>MISSION SUCCESS</div>
                <div style="font-size: 18px; margin-top: 10px;">See Behind the Scenes</div>
            </div>
        </div>
    </div>

    <script>
        // Game state management
        let gameState = {
            currentPage: 0,
            currentParagraph: 0,
            questionsAnswered: 0,
            sessionId: Math.random().toString(36).substr(2, 9),
            unlockedPages: [0],
            isTyping: false,
            videoWatched: false
        };

        // Story content
        const storyPages = [
            {
                title: "MISSION INITIATION AND ENEMY CONTACT",
                paragraphs: [
                    {
                        header: "8:30 PM - MISSION BEGINS",
                        subheader: "Success Probability: 85%",
                        content: "Agent left secure base after completing earlier objectives in Washington DC. Intelligence reports said enemy corporate spies (Sony Division) were detected in the area. Mission goal: Get the Target Device before enemy forces could mess up the supply chain."
                    },
                    {
                        header: "9:11 PM - REACHED PRIMARY TARGET LOCATION",
                        subheader: "Success Probability: 80%",
                        content: "Agent arrived at Best Buy Annapolis and immediately spotted surveillance activity. Multiple unknown people in business suits were taking notes on civilians waiting in line. First assessment: Corporate spy operation happening right now. Agent's cover as regular customer stayed secret."
                    },
                    {
                        header: "10:22 PM - GOT SPECIAL ACCESS PASS",
                        subheader: "Success Probability: 95%",
                        content: "Agent successfully got Priority Access Document (Ticket #23) guaranteeing access to Target Device bundle package. However, intercepted enemy communications revealed agents offering big money ($800+ cash) to ruin mission objectives. Enemy plan: Use money warfare against regular people."
                    },
                    {
                        header: "10:45 PM - FIRST ENEMY ATTACK CONFIRMED",
                        subheader: "Success Probability: 70%",
                        content: "Local police responded to illegal scalping operation. Three people arrested for trying to buy multiple units against the rules. Agent watched corporate spies retreat to watching positions in the parking lot. Mission success chances dropped due to increased security problems and enemy presence."
                    }
                ]
            },
            {
                title: "PROBLEMS AND INTELLIGENCE FAILURES",
                paragraphs: [
                    {
                        header: "11:30 PM - CRITICAL SUPPLY INTELLIGENCE",
                        subheader: "Success Probability: 60%",
                        content: "Store manager revealed inventory problem: 47 units available but 52 people in line wanting to buy. Agent faced tough decision: stay in current position with uncertain outcome or move to backup target (Target store) with reported emergency restocking. Analysis favored staying put because of guaranteed access ticket."
                    },
                    {
                        header: "12:30 AM - SYSTEM PROBLEMS AND DELAYS",
                        subheader: "Success Probability: 40%",
                        content: "Store opened but internal computer systems had operational failures. Agent observed 15-minute delay for manual counting of inventory. Three non-authorized people removed from line during security screening. Corporate spies offered more money to people in line, all offers rejected by civilian assets."
                    },
                    {
                        header: "3:00 AM - COMMUNICATION BLACKOUT",
                        subheader: "Success Probability: 70%",
                        content: "Agent's primary communication device lost power completely, resulting in total loss of intelligence dashboard connection. Operating under silent conditions with visual assessment only. Enemy forces returned with bigger financial offers (reports of $1,200+ offers). Agent maintained operational security without outside support."
                    },
                    {
                        header: "6:32 AM - EMERGENCY COMMUNICATIONS RESTORED",
                        subheader: "Success Probability: 80%",
                        content: "Successfully restored minimal power to communication device (1% battery left). Intelligence update confirmed Target store inventory completely sold out, proving agent's tactical decision to stay at Best Buy was correct. Only 8 civilians remained ahead of agent in line."
                    }
                ]
            },
            {
                title: "ASSET PROBLEMS AND SCOUTING OPERATIONS",
                paragraphs: [
                    {
                        header: "8:00 AM - OPERATIONAL INTERRUPTION",
                        subheader: "Success Probability: 60%",
                        content: "Agent required to temporarily leave position for critical asset maintenance (Brandy - support animal needing food and exercise). Negotiated position security with cooperative civilian assets. 45-minute absence from operational zone, position successfully maintained by civilian cooperation network."
                    },
                    {
                        header: "9:30 AM - ENEMY TERRITORY SCOUTING",
                        subheader: "Success Probability: 30%",
                        content: "Agent conducted surveillance operation at Target store to assess competitive threat level. Findings: Nintendo retail section completely empty, handwritten signs indicating total inventory sold out hours before. Intelligence confirmed Best Buy remained best acquisition point."
                    },
                    {
                        header: "10:15 AM - TACTICAL ASSESSMENT - MISSION CRITICAL",
                        subheader: "Success Probability: 15%",
                        content: "Secondary scouting revealed catastrophic supply situation at Target store. Gaming retail area stripped bare except for single corporate logo display. Mission success probability calculated at lowest point of entire operation. Standard protocol would recommend mission abort."
                    },
                    {
                        header: "COMMAND DECISION",
                        subheader: "Success Probability: 15%",
                        content: "Against all tactical recommendations and probability assessments, Agent elected to continue mission. Quote from field log: 'Going back to Best Buy to complete objective regardless of probability calculations. Some missions require completion based on doing what's right rather than statistics.' Agent demonstrated textbook persistence under impossible odds."
                    }
                ]
            },
            {
                title: "MISSION COMPLETION - AGAINST ALL ODDS",
                paragraphs: [
                    {
                        header: "11:45 AM - TACTICAL SITUATION REVERSAL",
                        subheader: "Success Probability: 98%",
                        content: "Upon return to Best Buy store, Agent discovered extraordinary development: Line significantly reduced due to civilian departures during overnight period. Ticket #23 now positioned Agent within optimal acquisition range. Mission success probability jumped from 15% to 98% within two-hour window."
                    },
                    {
                        header: "OPERATIONAL ANALYSIS",
                        subheader: "Success Probability: 98%",
                        content: "While Agent maintained position through adversity, competing civilians abandoned objectives when conditions became difficult. Strategic persistence resulted in tactical advantage that mathematical models had not predicted."
                    },
                    {
                        header: "12:19 PM - STORE PENETRATION ACHIEVED",
                        subheader: "Success Probability: 99%",
                        content: "Agent successfully entered Best Buy interior. 'In-Store Purchases Only' security protocols eliminated external interference from corporate spies. Mission success probability elevated to 99%. Agent proceeding to final acquisition phase."
                    }
                ]
            }
        ];

        // Question sets with randomization (2-3 questions per paragraph)
        const questionSets = {
            "0-0": [
                {
                    question: "What was Agent Scott's codename?",
                    answers: ["Switch Hunter", "Game Master", "Console King"],
                    correct: 0
                },
                {
                    question: "What division were the enemy spies from?",
                    answers: ["Microsoft Division", "Sony Division", "Apple Division"],
                    correct: 1
                },
                {
                    question: "Where did the agent complete earlier objectives?",
                    answers: ["Baltimore", "Washington DC", "Philadelphia"],
                    correct: 1
                }
            ],
            "0-1": [
                {
                    question: "Where did the agent arrive at 9:11 PM?",
                    answers: ["Target Annapolis", "Best Buy Annapolis", "GameStop Mall"],
                    correct: 1
                },
                {
                    question: "What were the unknown people wearing?",
                    answers: ["Business suits", "Casual clothes", "Security uniforms"],
                    correct: 0
                },
                {
                    question: "What was happening right now according to the first assessment?",
                    answers: ["Regular shopping", "Corporate spy operation", "Store closing"],
                    correct: 1
                }
            ],
            "0-2": [
                {
                    question: "What was the ticket number?",
                    answers: ["Ticket #21", "Ticket #23", "Ticket #25"],
                    correct: 1
                },
                {
                    question: "How much cash were enemy agents offering?",
                    answers: ["$600+", "$700+", "$800+"],
                    correct: 2
                },
                {
                    question: "What type of warfare were enemies using?",
                    answers: ["Cyber warfare", "Money warfare", "Information warfare"],
                    correct: 1
                }
            ],
            "0-3": [
                {
                    question: "How many people were arrested?",
                    answers: ["Two people", "Three people", "Four people"],
                    correct: 1
                },
                {
                    question: "What were the arrested people trying to do?",
                    answers: ["Cut in line", "Buy multiple units", "Steal products"],
                    correct: 1
                },
                {
                    question: "Where did corporate spies retreat to?",
                    answers: ["Inside the store", "Parking lot", "Nearby building"],
                    correct: 1
                }
            ],
            "1-0": [
                {
                    question: "How many units were available?",
                    answers: ["45 units", "47 units", "49 units"],
                    correct: 1
                },
                {
                    question: "How many people were in line?",
                    answers: ["50 people", "52 people", "54 people"],
                    correct: 1
                },
                {
                    question: "What was the backup target?",
                    answers: ["GameStop", "Target store", "Walmart"],
                    correct: 1
                }
            ],
            "1-1": [
                {
                    question: "How long was the delay for manual counting?",
                    answers: ["10 minutes", "15 minutes", "20 minutes"],
                    correct: 1
                },
                {
                    question: "How many non-authorized people were removed?",
                    answers: ["Two", "Three", "Four"],
                    correct: 1
                },
                {
                    question: "Who rejected the money offers?",
                    answers: ["Store security", "Civilian assets", "Police officers"],
                    correct: 1
                }
            ],
            "1-2": [
                {
                    question: "What device lost power?",
                    answers: ["Laptop computer", "Primary communication device", "GPS navigator"],
                    correct: 1
                },
                {
                    question: "How much money were enemies offering in bigger offers?",
                    answers: ["$1,000+", "$1,200+", "$1,500+"],
                    correct: 1
                },
                {
                    question: "What type of assessment was the agent using?",
                    answers: ["Audio assessment", "Visual assessment", "Digital assessment"],
                    correct: 1
                }
            ],
            "1-3": [
                {
                    question: "What percentage of battery was restored?",
                    answers: ["1% battery", "2% battery", "3% battery"],
                    correct: 0
                },
                {
                    question: "What happened to Target store inventory?",
                    answers: ["Running low", "Completely sold out", "Fully stocked"],
                    correct: 1
                },
                {
                    question: "How many civilians remained ahead of agent?",
                    answers: ["6 civilians", "8 civilians", "10 civilians"],
                    correct: 1
                }
            ],
            "2-0": [
                {
                    question: "What was the support animal's name?",
                    answers: ["Bailey", "Brandy", "Buddy"],
                    correct: 1
                },
                {
                    question: "How long was the absence?",
                    answers: ["30 minutes", "45 minutes", "60 minutes"],
                    correct: 1
                },
                {
                    question: "Who maintained the agent's position?",
                    answers: ["Store security", "Civilian cooperation network", "Police officers"],
                    correct: 1
                }
            ],
            "2-1": [
                {
                    question: "What was completely empty?",
                    answers: ["Gaming section", "Nintendo retail section", "Electronics area"],
                    correct: 1
                },
                {
                    question: "What type of signs indicated inventory status?",
                    answers: ["Digital signs", "Handwritten signs", "Printed signs"],
                    correct: 1
                },
                {
                    question: "What remained the best acquisition point?",
                    answers: ["Target store", "Best Buy", "GameStop"],
                    correct: 1
                }
            ],
            "2-2": [
                {
                    question: "What was stripped bare except for single display?",
                    answers: ["Electronics area", "Gaming retail area", "Computer section"],
                    correct: 1
                },
                {
                    question: "What would standard protocol recommend?",
                    answers: ["Continue mission", "Mission abort", "Change strategy"],
                    correct: 1
                },
                {
                    question: "What was at the lowest point?",
                    answers: ["Agent morale", "Mission success probability", "Store inventory"],
                    correct: 1
                }
            ],
            "2-3": [
                {
                    question: "What did the agent elect to do against recommendations?",
                    answers: ["Abandon mission", "Continue mission", "Change targets"],
                    correct: 1
                },
                {
                    question: "What did the agent demonstrate under impossible odds?",
                    answers: ["Quick thinking", "Textbook persistence", "Strategic planning"],
                    correct: 1
                },
                {
                    question: "According to the quote, what should missions be based on?",
                    answers: ["Statistics only", "Doing what's right", "Probability calculations"],
                    correct: 1
                }
            ]
        };

        // Utility functions
        function getRandomQuestionSet(pageIndex, paragraphIndex) {
            const key = `${pageIndex}-${paragraphIndex}`;
            const questions = questionSets[key];
            if (!questions) return null;
            
            const randomIndex = Math.floor(Math.random() * questions.length);
            return questions[randomIndex];
        }

        function typewriterEffect(element, text, duration = 20000, callback) {
            if (gameState.isTyping) return;
            
            gameState.isTyping = true;
            element.innerHTML = '';
            
            const chars = text.split('');
            const delay = duration / chars.length;
            let index = 0;
            
            function typeChar() {
                if (index < chars.length) {
                    element.innerHTML += chars[index];
                    index++;
                    setTimeout(typeChar, delay);
                } else {
                    gameState.isTyping = false;
                    if (callback) callback();
                }
            }
            
            typeChar();
        }

        function showQuestion(pageIndex, paragraphIndex, onCorrect) {
            const questionData = getRandomQuestionSet(pageIndex, paragraphIndex);
            if (!questionData) {
                onCorrect();
                return;
            }
            
            const questionContainer = document.createElement('div');
            questionContainer.className = 'question-container';
            questionContainer.style.display = 'block';
            
            questionContainer.innerHTML = `
                <div class="question-text">IDENTITY VERIFICATION: ${questionData.question}</div>
                <div class="answer-options">
                    ${questionData.answers.map((answer, index) => 
                        `<div class="answer-option" data-index="${index}">${answer}</div>`
                    ).join('')}
                </div>
                <div class="feedback-message" id="feedback"></div>
            `;
            
            const currentParagraph = document.querySelector('.paragraph:last-child');
            currentParagraph.appendChild(questionContainer);
            
            const options = questionContainer.querySelectorAll('.answer-option');
            const feedback = questionContainer.querySelector('#feedback');
            
            options.forEach(option => {
                option.addEventListener('click', function() {
                    const selectedIndex = parseInt(this.dataset.index);
                    
                    options.forEach(opt => opt.style.pointerEvents = 'none');
                    
                    if (selectedIndex === questionData.correct) {
                        feedback.className = 'feedback-message feedback-correct';
                        feedback.textContent = 'IDENTITY CONFIRMED - CLEARANCE GRANTED';
                        feedback.style.display = 'block';
                        
                        setTimeout(() => {
                            currentParagraph.style.opacity = '0';
                            setTimeout(() => {
                                currentParagraph.remove();
                                onCorrect();
                            }, 500);
                        }, 2000);
                    } else {
                        feedback.className = 'feedback-message feedback-incorrect';
                        feedback.textContent = 'IDENTITY NOT CONFIRMED - SECRET CLASSIFICATION COMPROMISED - MESSAGE WILL SELF-DESTRUCT IF IDENTITY NOT VALID';
                        feedback.style.display = 'block';
                        
                        setTimeout(() => {
                            feedback.style.display = 'none';
                            options.forEach(opt => opt.style.pointerEvents = 'auto');
                        }, 3000);
                    }
                });
            });
        }

        function loadParagraph(pageIndex, paragraphIndex) {
            const page = storyPages[pageIndex];
            const paragraph = page.paragraphs[paragraphIndex];
            
            if (!paragraph) {
                // Page complete, show transition
                showPageTransition(pageIndex);
                return;
            }
            
            const pageContent = document.getElementById('page-content');
            
            const paragraphDiv = document.createElement('div');
            paragraphDiv.className = 'paragraph';
            paragraphDiv.innerHTML = `
                <div class="paragraph-header">${paragraph.header}</div>
                <div style="font-weight: bold; color: #dc143c; margin-bottom: 15px;">${paragraph.subheader}</div>
                <div class="typed-content"></div>
            `;
            
            pageContent.appendChild(paragraphDiv);
            
            const typedContent = paragraphDiv.querySelector('.typed-content');
            
            typewriterEffect(typedContent, paragraph.content, 20000, () => {
                // Special handling for Page 4
                if (pageIndex === 3) {
                    // Page 4: No questions, continue to next paragraph or show video
                    if (paragraphIndex === 2) {
                        // After 12:19 PM paragraph, show video link
                        showVideoLink();
                    } else {
                        // Continue to next paragraph
                        gameState.currentParagraph++;
                        setTimeout(() => loadParagraph(pageIndex, gameState.currentParagraph), 1000);
                    }
                } else {
                    // Pages 1-3: Show question
                    showQuestion(pageIndex, paragraphIndex, () => {
                        gameState.currentParagraph++;
                        setTimeout(() => loadParagraph(pageIndex, gameState.currentParagraph), 1000);
                    });
                }
            });
        }

        function showVideoLink() {
            const pageContent = document.getElementById('page-content');
            
            const videoDiv = document.createElement('div');
            videoDiv.className = 'video-container';
            videoDiv.innerHTML = `
                <a href="#" class="video-link" id="video-link">ðŸŽ¬ FINAL TRANSMISSION - WATCH MISSION SUCCESS</a>
            `;
            
            pageContent.appendChild(videoDiv);
            
            document.getElementById('video-link').addEventListener('click', function(e) {
                e.preventDefault();
                // Simulate video watching
                gameState.videoWatched = true;
                videoDiv.remove();
                
                // Continue with remaining paragraphs
                const remainingParagraphs = [
                    {
                        header: "12:24 PM - MISSION ACCOMPLISHED",
                        subheader: "Success Probability: 100%",
                        content: "Target Device successfully acquired: Nintendo Switch 2 + Mario Kart World Bundle. Mission duration: 15 hours 54 minutes. All objectives completed despite multiple system failures, enemy interference, communication blackouts, and asset complications."
                    },
                    {
                        header: "MISSION DEBRIEF SUMMARY",
                        subheader: "Success Probability: 100%",
                        content: "Operation demonstrated that strategic persistence can overcome statistical probability calculations. Mission succeeded through Agent's refusal to abort objective despite 15% success probability at critical decision point. Target Device delivered to Asset Zach as planned."
                    },
                    {
                        header: "END MISSION REPORT",
                        subheader: "Agent 007 - Mission Success Confirmed",
                        content: "CLASSIFICATION: Mission file to remain TOP SECRET until Asset Zach clearance granted for operational details. This document contains classified operational details for authorized personnel only. Unauthorized disclosure prohibited."
                    }
                ];
                
                let paragraphIndex = 0;
                
                function typeRemainingParagraphs() {
                    if (paragraphIndex < remainingParagraphs.length) {
                        const paragraph = remainingParagraphs[paragraphIndex];
                        
                        const paragraphDiv = document.createElement('div');
                        paragraphDiv.className = 'paragraph';
                        paragraphDiv.innerHTML = `
                            <div class="paragraph-header">${paragraph.header}</div>
                            <div style="font-weight: bold; color: #dc143c; margin-bottom: 15px;">${paragraph.subheader}</div>
                            <div class="typed-content"></div>
                        `;
                        
                        pageContent.appendChild(paragraphDiv);
                        
                        const typedContent = paragraphDiv.querySelector('.typed-content');
                        
                        typewriterEffect(typedContent, paragraph.content, 1667, () => {
                            paragraphIndex++;
                            setTimeout(typeRemainingParagraphs, 500);
                        });
                    } else {
                        // All paragraphs complete, show final link
                        setTimeout(() => {
                            document.getElementById('final-link').style.display = 'block';
                        }, 5000);
                    }
                }
                
                typeRemainingParagraphs();
            });
        }

        function showPageTransition(pageIndex) {
            const transitionMessage = document.getElementById('transition-message');
            
            const messages = [
                'BIOMETRICS CONFIRMED - ACCESSING NEXT CLASSIFIED SECTION',
                'SECURITY CLEARANCE VERIFIED - PROCEEDING TO PHASE 2',
                'AGENT AUTHORIZATION VALIDATED - FINAL PHASE UNLOCKED',
                'MISSION COMPLETE - ACCESSING DEBRIEF'
            ];
            
            transitionMessage.textContent = messages[pageIndex];
            transitionMessage.style.display = 'block';
            
            setTimeout(() => {
                transitionMessage.style.display = 'none';
                
                if (pageIndex < 3) {
                    gameState.currentPage++;
                    gameState.currentParagraph = 0;
                    gameState.unlockedPages.push(gameState.currentPage);
                    
                    updateTabs();
                    loadPage(gameState.currentPage);
                }
            }, 5000);
        }

        function loadPage(pageIndex) {
            const page = storyPages[pageIndex];
            const pageContent = document.getElementById('page-content');
            
            pageContent.innerHTML = `
                <div class="page-header">${page.title}</div>
            `;
            
            gameState.currentParagraph = 0;
            loadParagraph(pageIndex, 0);
        }

        function updateTabs() {
            const tabs = document.querySelectorAll('.tab');
            
            tabs.forEach((tab, index) => {
                if (gameState.unlockedPages.includes(index)) {
                    tab.classList.remove('locked');
                    if (index === gameState.currentPage) {
                        tab.classList.add('active');
                    } else {
                        tab.classList.remove('active');
                    }
                } else {
                    tab.classList.add('locked');
                    tab.classList.remove('active');
                }
            });
        }

        // Event listeners
        document.getElementById('dossier-cover').addEventListener('click', function() {
            document.getElementById('dossier-cover').style.display = 'none';
            document.getElementById('dossier-content').style.display = 'block';
            
            loadPage(0);
        });

        document.getElementById('final-link').addEventListener('click', function() {
            // Placeholder for "Behind the Scenes" link
            alert('Behind the Scenes link will be added here!');
        });

        // Prevent page refresh cheating
        window.addEventListener('beforeunload', function() {
            gameState = {
                currentPage: 0,
                currentParagraph: 0,
                questionsAnswered: 0,
                sessionId: Math.random().toString(36).substr(2, 9),
                unlockedPages: [0],
                isTyping: false,
                videoWatched: false
            };
        });

        // Tab click handlers
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const pageIndex = parseInt(this.dataset.page);
                
                if (!gameState.unlockedPages.includes(pageIndex)) {
                    return; // Can't access locked pages
                }
                
                if (gameState.isTyping) {
                    return; // Can't switch during typing
                }
                
                gameState.currentPage = pageIndex;
                updateTabs();
                loadPage(pageIndex);
            });
        });

        // Initialize
        updateTabs();
    </script>
</body>
</html>